#Ejercicio 2DDCT
#install.packages("pacman"), porque ya lo corrimos en R
library ("pacman")
p_load("ggplot2", "dplyr", "vroom")

Datos_PCR <- vroom(file="https://raw.githubusercontent.com/ManuelLaraMVZ/resultados_PCR_practica/refs/heads/main/Genes.csv")
Datos_PCR

#GOIs-gen de referencia
Gen_ref <- Datos_PCR %>%
  filter(Gen == "B-actina") #== significa "que diga exactamente igual"
Gen_ref

Gen_int <- Datos_PCR %>%
  filter(Gen != "B-actina")  %>% #!= significa menos la fila de la actina
  select (-1) #elimina la columna de las operaciones
Gen_int

DCT <- Gen_int %>%
  mutate(DC1 = C1 - Gen_ref$C1,
         DC2 = C2 - Gen_ref$C2,
         DC3 = C3 - Gen_ref$C3,
         DT1 = T1 - Gen_ref$T1,
         DT2 = T2 - Gen_ref$T2,
         DT3 = T3 - Gen_ref$T3) %>% #mutate crea nuevas columnas, $ es para seleccionar esa columma de esa base de datos
  select(-1:-6)  %>% #el : es como de-hasta
  

DCT
